{{ config(
    materialized='incremental',
    unique_key= ['COMPANY_REFERENCE_HK', 'LOAD_DATETIME']
) }}

{%- set yaml_metadata -%}
source_model: "stg_company_info__instellingen"
src_pk: "COMPANY_REFERENCE_HK"
src_hashdiff: "HASHDIFF"
src_payload:
    - "sizokey"
    - "sizokey_md"
    - "sizokey_up"
    - "sizolockey"
    - "sizolocidm"
    - "sizokix"
    - "sizopcd4"
    - "bagopndid"
    - "sizokvk"
    - "sizorsin"
    - "sizoves"
    - "sizonm"
    - "sizostn"
    - "sizohn1"
    - "sizohn2"
    - "sizohn3"
    - "sizonm_up"
    - "sizoadr"
    - "sizostr"
    - "sizohnr"
    - "sizothn"
    - "sizopcd"
    - "sizoplt"
    - "sizocadr"
    - "sizocstr"
    - "sizochnr"
    - "sizocthn"
    - "sizocpcd"
    - "sizocplt"
    - "sizopbadr"
    - "sizopbpb"
    - "sizopbnr"
    - "sizopbpcd"
    - "sizopbplt"
    - "sizotel"
    - "sizttel"
    - "sizotelv"
    - "sizttelv"
    - "sizotelm"
    - "sizttelm"
    - "selloph"
    - "selladrft"
    - "sellmlst"
    - "selkjurent"
    - "sellbdm"
    - "sellbtm"
    - "sellimp"
    - "sellexp"
    - "sizlbmn"
    - "sizlio"
    - "sizcbyztyp"
    - "sizlhfdgbr"
    - "sizocilink"
    - "sizwam"
    - "sizkam"
    - "sizosbi"
    - "sizosbi2"
    - "sizosbiseg"
    - "sizonace"
    - "sizchnv"
    - "sizcrv"
    - "sizkrv"
    - "sizdopr"
    - "sizwoprjr"
    - "siztoprdat"
    - "sizwlft"
    - "sizklft"
    - "sizwfil"
    - "sizcbnc1"
    - "sizkbnc1"
    - "sizobtw"
    - "sizpmarbr"
    - "sizkmarbr"
    - "sizpcloba"
    - "sizkcloba"
    - "sizlint"
    - "sellbrv"
    - "sizourl"
    - "sizckvkdis"
    - "sizctypove"
    - "sizctypond"
    - "sizofr_frm"
    - "sizcfr_srt"
    - "sizcfr_gev"
    - "sizcfr_nem"
    - "sizcfr_rel"
    - "sizlmdmu_l"
    - "sizlmdmu_c"
    - "sizoskdmul"
    - "sizoskdmuc"
    - "sizcbeslv"
    - "sizlbdmu_l"
    - "sizocontlr"
    - "sizoloctlr"
    - "sizwhinivo"
    - "sizccorel"
    - "sizostart"
    - "sizcstart"
    - "sizczzp"
    - "sizczzptyp"
    - "sizdvrh"
    - "siztvrhdat"
    - "sizdnmw"
    - "siztnmwdat"
    - "sizobmkey"
    - "sizrsortc"
    - "sizwboom"
    - "creckredwa"
    - "sizlverrv"
    - "sizcveradr"
    - "sellip"
    - "sellsubsde"
src_extra_columns:
    - "END_DATETIME"
src_ldts: "LOAD_DATETIME"
src_source: "RECORD_SOURCE"
{%- endset -%}

{% set metadata_dict = fromyaml(yaml_metadata) %}

{{ add_end_datetime_to_sat(metadata_dict) }}
